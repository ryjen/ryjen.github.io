<!doctype html>
<html class="no-js" lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>why golang</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="google-site-verification" content="jkdqcIgCmfBgfd8S0WbF3CqZ-TXSSayerVq4mqO0Fc0" />
<meta name="google-site-verification" content="Crk6W-ckoApRrOZrv23ngLwPPTbzjzfZ4AQPElgS0pw" />
<meta name="google-site-verification" content="Crk6W-ckoApRrOZrv23ngLwPPTbzjzfZ4AQPElgS0pw" />
<meta name="description" content="a namespace for technical and musical musings" />
<meta name="ROBOTS" CONTENT="INDEX, FOLLOW">

    
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,900&family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/css/theme.min.css">


<link href="/css/app.min.css" rel="stylesheet">




    <meta name="generator" content="Hugo 0.68.3" />

  </head>
  <body>

    <div id="background">
    </div>

    

    
    <div id="header" class="clearfix">
    

      
      <div class="container clearfix">
        <div id="brand">
          <a href="/">
  <img src="/image/logo.svg" alt="logo" width="40" height="40" /> <span class="brand">ryan jennings</span>
</a>

        </div>
        <div id="menu-toggle">
        <i class="fas fa-bars"></i></div>
        <nav>
          
          <ul class="nav navbar-nav menu">
            
            <li class="nav-toggle blog">
              <a href="/post" title="blog">
                
                <i class="fas fa-rss"></i>
                
                <span class="nav-name">blog</span>
              </a>
            </li>
            
            <li class="nav-toggle music">
              <a href="/music" title="music">
                
                <i class="fas fa-music"></i>
                
                <span class="nav-name">music</span>
              </a>
            </li>
            
            <li class="nav-toggle doodles">
              <a href="/doodles" title="doodles">
                
                <i class="fas fa-paint-brush"></i>
                
                <span class="nav-name">doodles</span>
              </a>
            </li>
            
            <li class="nav-toggle things">
              <a href="/things" title="things">
                
                <i class="fas fa-object-ungroup"></i>
                
                <span class="nav-name">things</span>
              </a>
            </li>
            
          </ul>
          

          
          <ul class="nav navbar-icons context-menu">
            
            <li class="navbar-icon"><a href="mailto:robert@ryanjennin.gs"><i class="fas fa-envelope"></i></a></li>
            
            <li class="navbar-icon"><a href="https://micrantha.com"><i class="fas fa-building"></i></a></li>
            
            <li class="navbar-icon"><a href="https://github.com/ryjen"><i class="fab fa-github"></i></a></li>
            
            <li class="navbar-icon"><a href="https://linkedin.com/in/ryjen"><i class="fab fa-linkedin"></i></a></li>
            
          </ul>
          
        </nav>
      </div>
    </div>

    <div class="container">


<div id="main">

    <h1>why golang</h1>

    <p class="timestamps">Created: July 24, 2020 </p>

    <div class="text-justify"><p>Have become a fan boy of <a href="https://golang.org">golang</a> as a replacement for my beloved C purely because it is so simplified, and thus a <strong>guru</strong> language to me.</p>
<p>As it stands now, I am somewhat burned out in the depths of a mid-life crisis and pandemic.  Do not have, or want, the memory capacity for anything more complex or verbose.</p>
<p>A language like go meets these soft skill requirements more than others:</p>
<ul>
<li>is not verbose</li>
<li>does not mix strict object oriented principles with other principles (functional, extensions)</li>
<li>implementations from different people are mostly consistent</li>
<li>sufficient tooling</li>
<li>efficient with no virtual machine or binary dependency</li>
<li>cross platform and C-compatible binaries</li>
<li>used in industry</li>
</ul>
<p><a href="">Rust</a> is a very close second only because it is more verbose and you have to master the borrow checker.
<a href="">Swift</a> suffers from implementation differences and the apple bias, but benefits from optimizations.
<a href="">C++</a> is hell if a person is not pragmatic enough to use wisely and strictly.</p>
<p>The rest of the languages are great in their own right but do not meet my needs.</p>
<p>Frontend work it is hard to avoid javascript for web.  For mobile languages are locked into swift/objc or java/kotlin. Cross-mobile frameworks are more common and to keep transferable with web, you might as well use a javascript one.</p>
<p>Possible modern language upgrade paths:</p>
<p>Legacy || Modern
&mdash; | &mdash;
C | Go
C++, Objc | Rust
Objc | Swift
Java | Kotlin, Scala, Clojure
Erlang | Elixir
VB | C#, F#
JS | TypeScript, Babel</p>
<p>A common problem with libraries and frameworks is <a href="https://en.wikipedia.org/wiki/Overchoice">overchoice</a>.  One does not need overchoice in the fundamental idiosyncrasies of a language.</p>
<p>That being said, wanted a closer look at some things.</p>
<h2 id="golang-testing-and-assertions">golang testing and assertions</h2>
<p>Will assume you are familiar with testing in go and the various frameworks.</p>
<h3 id="assertions">assertions</h3>
<p>In my experience, assertion frameworks in general are sometime overkill, or in other words are unnecessary verbose.</p>
<p>Methods like <strong>IsFalse()/IsTrue()</strong> or <strong>IsNil()/IsNotNil()</strong> are superfluous or could be reduced to a simple boolean if check.</p>
<p>Golang does not include an assertion framework.  That being said, writing repeated if conditions can still be tedious and a more fluent way may be desired.</p>
<p>In the spirit of simplicity, a fluent assertion can be reduced to a wrapper for a single boolean condition.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#75715e">// +build test
</span><span style="color:#75715e"></span>
<span style="color:#f92672">package</span> <span style="color:#a6e22e">assert</span>

<span style="color:#75715e">// Action for a condition
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Action</span> <span style="color:#66d9ef">func</span>()

<span style="color:#75715e">// Handler for a condition
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Context</span> <span style="color:#66d9ef">struct</span> {
  <span style="color:#75715e">// the context value if any
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">value</span> <span style="color:#66d9ef">string</span>
  <span style="color:#75715e">// the condition to handle
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">condition</span> <span style="color:#66d9ef">bool</span>
}

<span style="color:#75715e">// Then performs the action
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Context</span>) <span style="color:#a6e22e">Then</span>(<span style="color:#a6e22e">action</span> <span style="color:#a6e22e">Action</span>) {
  <span style="color:#75715e">// Check the test condition...
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">condition</span> {
    <span style="color:#75715e">// and perform the action if needed.
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// typically a failure indication.
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">action</span>()
	}
  <span style="color:#75715e">// if the condition is not true the action is ignored
</span><span style="color:#75715e"></span>}

<span style="color:#75715e">// When tests a condition for an action
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">When</span>(<span style="color:#a6e22e">condition</span> <span style="color:#66d9ef">bool</span>) <span style="color:#a6e22e">Handler</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Handler</span>{<span style="color:#a6e22e">condition</span>: <span style="color:#a6e22e">condition</span>}
}
</code></pre></div><p>Running an action for a failed boolean condition handles ~95% of unit testing.</p>
<p>Some examples:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestLogic</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
  <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">performLogic</span>()
  <span style="color:#a6e22e">When</span>(<span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span>).<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>)
}
</code></pre></div><p>This test performs the logic functionality, when there is an error condition, the standard failure method is used.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestLogicVerbose</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
  <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">performLogic</span>()
  <span style="color:#a6e22e">When</span>(<span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span>).<span style="color:#a6e22e">Do</span>(<span style="color:#66d9ef">func</span>() {
    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;performing logic failed:&#34;</span>, <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
  })
}
</code></pre></div><p>In this example, when the logic functionality has an error condition, a custom action reports the failure with a message.</p>
<h2 id="resource-dependencies-and-cleanup">resource dependencies and cleanup</h2>
<p>In some tests there are dependencies on external resources such as a file system or a database.</p>
<p>Golang does not provide the junit style <strong>Before</strong> or <strong>After</strong> hooks like some testing frameworks.</p>
<p>Instead there is a <strong>Cleanup</strong> hook and the ability to <strong>run sub-tests</strong> from within a test to preserve state.</p>
<p>For example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestWrite</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {

  <span style="color:#75715e">// the data to use for IO
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">expected</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">randomData</span>()

  <span style="color:#75715e">// register a cleanup after the test
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Cleanup</span>(<span style="color:#66d9ef">func</span>() {
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">Remove</span>(<span style="color:#a6e22e">expected</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
      panic(<span style="color:#a6e22e">err</span>)
    }
  })

  <span style="color:#75715e">// Write to storage
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">expected</span>)
  <span style="color:#a6e22e">When</span>(<span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span>).<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>)

  <span style="color:#75715e">// Run a sub test to read data back
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {

    <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">storage</span>.<span style="color:#a6e22e">Read</span>()

    <span style="color:#a6e22e">When</span>(<span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span>).<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>)
    <span style="color:#a6e22e">When</span>(<span style="color:#a6e22e">result</span> <span style="color:#f92672">!=</span> <span style="color:#a6e22e">expected</span>).<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Fail</span>)
  })
}
</code></pre></div><p>In this example the test some data is generated to read/write and a cleanup hook is registered to remove it.</p>
<p>The unit test writes the data and runs a sub test to read it back, asserting failure on errors.</p>
<p>When the test and the sub-test have finished the cleanup hook will run and remove the resource.</p>
<h2 id="conclusion">conclusion</h2>
<p>So simple, so clean, so guru.  No fuss, no muss.</p>
<p>I am also a fan of <strong><a href="">behaviour driven development</a></strong> when it comes to unit testing</p>
</div>

</div>

</div>





<hr>

<div class="container">


    <div id="related">
        <h5>Related:</h5>

         <div class="card item bg-default clearfix">

    
    

      

    <p class="pull-right">July 7, 2020</p>
    <h4><a href="/2020/07/07/myths-fading-direction-of-evolution/">Myths Fading, Direction of Evolution</a></h4>
    <h5>a look at the current state of humanity</h5>

     <span class="item-tag">consciousness</span>  <span class="item-tag">ego</span>  <span class="item-tag">evolution</span>  <span class="item-tag">spirituality</span>  <span class="item-tag">philosophy</span> 

</div>
  <div class="card item bg-default clearfix">

    
    

      

    <p class="pull-right">January 22, 2018</p>
    <h4><a href="/2018/01/22/fortunes-on-slack/">Fortunes on Slack</a></h4>
    <h5>witty antidotes in a service</h5>

     <span class="item-tag">golang</span>  <span class="item-tag">slack</span>  <span class="item-tag">api</span>  <span class="item-tag">droplet</span>  <span class="item-tag">micro-service</span>  <span class="item-tag">docker</span>  <span class="item-tag">dokku</span>  <span class="item-tag">HTTP</span>  <span class="item-tag">rest</span>  <span class="item-tag">go</span>  <span class="item-tag">fortunes</span>  <span class="item-tag">micrantha</span>  <span class="item-tag">postgres</span>  <span class="item-tag">git</span> 

</div>
 

    </div>


</div>



<hr>

<div class="container">

	
	  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "arg3" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	

</div>


</div>

<div id="footer">




<script type="text/javascript">
  var _paq = window._paq || [];
   
  _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
  _paq.push(["setCookieDomain", "ryanjennin.gs"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.micrantha.com/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//analytics.micrantha.com/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt="" /></p></noscript>








<div class="center">
	© all rights reserved, ryan jennings
</div>

</div>


<script src="/js/theme.min.js"></script>


<script src="/js/app.min.js"></script>
<script data-goatcounter="https://analytics.micrantha.com/count"
        async src="//analytics.micrantha.com/count.js"></script>


<script>hljs.initHighlightingOnLoad();</script>







</body>
</html>


