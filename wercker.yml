box: digitallyseamless/nodejs-bower-grunt
build:
  steps:
    - wercker/npm-install@1.1.4
    - plasticine/bower-install@0.0.4
    - add-ssh-key:
        keyname: dokku
        host: beamer.arg3.com
    - script:
        name: Initialize git submodules
        code: |
            git submodule update --init --recursive
    - script:
        name: Build assets
        code: ./node_modules/.bin/brunch build
    - arjen/hugo-build:
        version: "0.15"
deploy:
  steps:
    - add-to-known_hosts:
        hostname: $GIT_DEPLOY_HOST
    - add-ssh-key:
        keyname: dokku
    - script:
        name: Synchronize deploy files
        code: |
          ./sync_deploy
    - script:
        name: push to dokku
        code: |
          cd ./deploy
          git add -A .
          git commit -m "deploy from wercker ($WERCKER_BUILD_URL)"
          git push
