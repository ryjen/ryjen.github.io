<!doctype html>
<html class="no-js" lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>c hacking: polymorphing 2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta name="description" content="The fortunes api serves witty antidotes from the UNIX world that relieve project tensions.">
    <meta name="keywords" content="unix,fortunes,micrantha,ryjen,ryan,jennings,coda,humour,humor,micro,microservice,micro-service,api,poems,proverbs,cookie,definitions,joke">
    <link rel="manifest" href="site.webmanifest">
    <link rel="apple-touch-icon" href="/icon/icon.png">

    
<link rel="stylesheet" href="/css/normalize.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/skeleton.css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata|Lora|Raleway" rel="stylesheet">
<style type="text/css">

#header {
	
    background-color: mediumseagreen;
    

    
    color: whitesmoke;
    
    
}

</style>

<link rel="stylesheet" href="/css/main.css">



 

    <meta name="generator" content="Hugo 0.34" />

</head>
<body>



<div id="header" class="clearfix">
    
    <div class="container clearfix">
        <span id="menu-toggle">&equiv;</span>
        <div id="brand">
			<a href="/">
	<img src="/image/logo-light.svg" alt="logo" width="40" height="40" /> <span>coda life</span>
</a>

        </div>
        <nav>
            
                <ul class="nav navbar-nav">
                    
                        <li class="nav-toggle blog">
                            
                            <i class="fa fa-rss"></i> 
                            
                            <a href="/post">blog</a>
                        </li>
                    
                        <li class="nav-toggle music">
                            
                            <i class="fa fa-music"></i> 
                            
                            <a href="/music">music</a>
                        </li>
                    
                        <li class="nav-toggle things">
                            
                            <i class="fa fa-object-ungroup"></i> 
                            
                            <a href="/things">things</a>
                        </li>
                    
                </ul>
            


            
                <ul class="nav navbar-icons">
                    
                        <li class="navbar-icon"><a href="mailto:ryan@coda.life"><i class="fa fa-envelope-o"></i></a></li>
                    
                        <li class="navbar-icon"><a href="https://github.com/ryjen/"><i class="fa fa-github"></i></a></li>
                    
                </ul>
            
        </nav>
    </div>
</div>

<div class="container">


<div id="main">

	<h2>c hacking: polymorphing 2</h2>

    <div class="text-justify">

<p>While working on <a href="http://github.com/ryjen/cparse">cparse</a> I found another nifty way to sort of simulate polymorphism.</p>

<h1 id="cparse">cparse</h1>

<p>Another exercise in futility, a C implementation for the  REST api at <a href="http://parse.com">parse.com</a>.  Really the core of it is a web client and an object structure using json.</p>

<h1 id="polymorphing">polymorphing</h1>

<p>I started off by having separate structure for the different type of objects, but I quickly realized there was a lot of code duplication.
To solve this I used a combination of type defines and function pointers to the library API appear to be working with a seperate type, but are indeed still working with the base object type.</p>

<p>So for an example, I&rsquo;ll explain an object and user types.</p>

<h2 id="object">object</h2>

<pre><code class="language-c">/* the alias */
typedef struct cparse_object cParseObject;

/* the definition */
struct cparse_object
{
	char *objectId;
	cParseJson *attributes;
	/* etc. */
};

/* functions to operate on objects */

bool cparse_object_save(cParseObject *obj, cParseError **error);

bool cparse_object_delete(cParseObject *obj, cParseError **error);

/* etc */

</code></pre>

<h2 id="user">user</h2>

<pre><code class="language-c">/* the alias: note that it is aliasing an object */
typedef struct cparse_object cParseUser;

/* implementation of functions to operator on users: note that they point to object functions */

bool (*cparse_user_save)(cParseUser *obj, cParseError **error) = cparse_object_save;

bool (*cparse_user_delete)(cParseUser *obj, cParseError **error) = cparse_object_delete;

/* etc */

</code></pre>

<h2 id="example-usage">example usage</h2>

<pre><code class="language-c">
/* example object */
cParseObject *obj = cparse_object_new();

cparse_object_save(obj, &amp;error);


/* example user */
cParseUser *user = cparse_user_new();

cparse_user_save(user, &amp;error);

</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>As you can see from the example, the library API appears to be working with two distinct objects.  Using JSON as an object structure allows the object type to be resused (aliased) into other types this way without worrying about its members.  User objects can be passed directly to object functions as parameters without any issues.</p>

<p>Another benefit of this implementation is if the user object ever does become a distinct seperate object, the library API does not change or affect existing code!</p>

<p>Cheers!</p>
</div>

</div>

</div>





<hr>

<div class="container">


    <div id="related">
        <h5>Related:</h5>

         <div class="card item bg-default clearfix">

    
    

      

    <p class="pull-right">November 27, 2016</p>
    <h4><a href="/2016/11/27/microsoft-dev-stack-on-macos/">Microsoft Dev Stack on macOS</a></h4>
    <h5>a microsoft cross-platform mobile and cloud first development stack on macOS</h5>

     <span class="item-tag">development</span>  <span class="item-tag">programming</span>  <span class="item-tag">cross platform</span>  <span class="item-tag">mobile</span>  <span class="item-tag">web</span> 

</div>
  <div class="card item bg-default clearfix">

    
    

      

    <p class="pull-right">February 20, 2014</p>
    <h4><a href="/2014/02/20/java-key-path-json-objects/">Java Key Path Json Objects</a></h4>
    <h5>emulating key-value coding in java</h5>

     <span class="item-tag">java</span>  <span class="item-tag">json</span>  <span class="item-tag">key path</span>  <span class="item-tag">programming</span> 

</div>
  <div class="card item bg-default clearfix">

    
    

      

    <p class="pull-right">November 30, 2012</p>
    <h4><a href="/2012/11/30/poor-mans-polymorphism/">Poor Man&#39;s Polymorphism</a></h4>
    <h5>hacking in c</h5>

     <span class="item-tag">c</span>  <span class="item-tag">polymorphism</span>  <span class="item-tag">programming</span> 

</div>
 

    </div>


</div>



<hr>

<div class="container">

	
	  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "arg3" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	

</div>


</div>

<div class="center">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-5084920929867043"
         data-ad-slot="3126644849"
         data-ad-format="auto"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>


<hr>




<footer class="center">
	&copy; all rights reserved, ryan jennings
</footer>


    <script src="/js/vendor/modernizr-3.5.0.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/vendor/jquery-3.2.1.min.js"><\/script>')</script>
<script src="/js/plugins.js"></script>
<script src="/js/main.js"></script>





 


</body>
</html>

