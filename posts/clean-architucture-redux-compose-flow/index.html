<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Clean Architecture + Redux + Android</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="dark light"><meta name=google-site-verification content="Crk6W-ckoApRrOZrv23ngLwPPTbzjzfZ4AQPElgS0pw"><meta name=description content="Web logs of a software development engineer, musician, artist and hockey player."><meta name=robots content="index, follow"><link rel=stylesheet href=/css/theme.min.css type=text/css><link href=/css/app.min.css rel=stylesheet type=text/css></head><body id=dark><header id=header class=shoulders><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><figure class="image is-32x32 mr-3"><img class=is-rounded src=https://gravatar.com/avatar/7cb4299e74a72928a9f05e8e910f07d5 alt=logo></figure>ryan jennings
</a><a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=nav><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></a></div><div id=nav class=navbar-menu><div class=navbar-end><a class=navbar-item href=/posts><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#rss"/></svg>
</span>blog
</a><a class=navbar-item href=/art><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#icons"/></svg>
</span>art
</a><a class=navbar-item href=/things><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#object-ungroup"/></svg>
</span>things
</a><a class=navbar-item href=/about><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#info-circle"/></svg>
</span>about</a><div class="is-flex is-align-items-center"><a role=button class=navbar-item href=https://github.com/ryjen aria-label=github><span class="icon is-small"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/brands.svg#github"/></svg>
</span></a><a role=button class=navbar-item href=/resume aria-label=resume><span class="icon is-small"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#file"/></svg>
</span></a><a role=button class="navbar-item themer" href=# aria-label=theme><span class="icon is-small"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#yin-yang"/></svg></span></a></div></div></div></nav></header><section id=main class=abdomen><div class="container pb-6"><nav class=breadcrumb aria-label=breadcrumbs><ul><li><a href=/>Home</a></li><li><a href=/posts/>Blog</a></li><li class=is-active><a href=/posts/clean-architucture-redux-compose-flow/>Clean Architecture + Redux + Android</a></li></ul></nav></div><div class=container><h1 class=title>Clean Architecture + Redux + Android</h1><div class=content><p>Have been learning a new tricks in mobile architecture on the native side.</p><p>Applying the redux pattern to android architecture components and MVVM has been interesting.</p><p>I have written some brief overviews of such things - if talk is cheap and just want the code - check out <a href=https://github.com/ryjen/namegame>namegame</a> or <a href=https://github.com/ryjen/jokeapp-droid>jokeapp</a>.</p><h2 id=jetpack-compose>Jetpack Compose</h2><p><a href=https://developer.android.com/jetpack/compose>Android compose</a> is a modern declarative toolkit for building user interfaces.</p><p>Inputs to compose functions become important in determining whether the UI should re-compose.</p><p>You can remember values for re-composing, but the state is the function parameters.</p><p>The ability to control which functions re-render is in-line with virtual doms of react-native.</p><p>Less code, simpler, easier to maintain (reminds me of a functional more efficient Java Mobile Edition)</p><h2 id=kotlin-flow>Kotlin Flow</h2><p><a href=https://developer.android.com/kotlin/flow>Kotlin flow</a> borrows from Reactive extensions and Golang channels to allow observable streams that produce and consume state.</p><p>This works well with compose in that state produced from a kotlin flow can trigger a compose function to recompose.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl>  <span class=k>val</span> <span class=py>state</span> <span class=k>by</span> <span class=n>viewModel</span><span class=p>.</span><span class=n>stateFlow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>Screen</span><span class=p>(</span><span class=n>state</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=clean-architecture>Clean Architecture</h2><p><a href=http://cleancoder.com>Clean architecture</a> from uncle bob has been around a while and defines principles for low complexity maintable code.</p><p>The principles are known as the <strong>SOLID</strong> acronym. They were somewhat intuitive and may have already been practicing them, but its nice there is a formal definition.</p><p>To promote the use of these principles it is helpful to layer a code base (typically <em>data</em>, <em>domain</em> and <em>ui</em>).</p><p>For example when sending data from the data layer to the ui layer, it becomes necessary to define an interface for it which is the <strong>D</strong>ependency inversion principle.</p><h2 id=redux--flux--composable>Redux / Flux / Composable</h2><p>The <a href=https://redux.js.org/tutorials/fundamentals/part-1-overview>overview</a> says &ldquo;redux is a pattern for managing application state using events&rdquo;.</p><p><a href=https://facebook.github.io/flux/docs/in-depth-overview/>Flux</a> uses multiple stores and makes more use of a dispatcher where redux provides a single store, reducers, and immutability.</p><p>Keeping state immutable is important when complexity grows, to eliminate the possibility of modules modifying your state outside of scope.</p><p>Thinking of clean architecture, the redux pattern follows the <em>Single Responsibility</em> principle. Perhaps a bit more cohesive to me than similar architectures (MVI).</p><p>I betray the single store principle of redux on Android, as they recommend keeping state in scope of a view model.</p><h4 id=store-and-reducers>Store and Reducers</h4><p>A brief intro to redux if you have never used:</p><p>Modifying immutable state is done by passing state through <strong>reducers</strong> to return a new state.</p><p>The <strong>store</strong> publishes and subscribes to events and maintains state from reducers.</p><h4 id=action>Action</h4><p>Actions are events that hook into the application, such as user interface, and dispatched to the store.</p><p><code>onClick={ dispatch(ViewAction.ButtonClicked) }</code></p><h4 id=middleware-or-effects>Middleware or Effects</h4><p>The store sometimes has middleware that performs effects on actions that <strong>do not return a new state</strong>.</p><p>In the web world, this is <em>middleware</em>, in the mobile world, this seems to be called &ldquo;<em>effects</em>&rdquo; (<a href=https://www.raywenderlich.com/24550178-getting-started-with-the-composable-architecture>composable architecture</a>).</p><h2 id=summary>Summary</h2><p>The unidirectional immutable data flow of redux and clean architecture allows maintainable reliable code.</p><p>Combined with subscribable state flows, coroutines and jetpack compose ui, it opens many doors to very sophisticated user experiences without the fuss.</p><h2 id=references>References</h2><ul><li><a href=https://www.raywenderlich.com/24550178-getting-started-with-the-composable-architecture>Composable Architecture</a></li><li><a href=https://developer.android.com/jetpack/compose>Android compose</a></li><li><a href=https://developer.android.com/kotlin/flow>Kotlin flow</a></li><li><a href=http://cleancoder.com>Clean Architecture</a></li><li><a href=https://github.com/ryjen/jokeapp-droid>Joke App</a> (jokes from <a href=https://icanhazdadjoke.com/>icanhazdadjoke.com</a>)</li><li><a href=https://jayrambhia.com/blog/android-redux-intro>android-redux-intro</a></li><li><a href=https://redux.js.org/tutorials/fundamentals/part-1-overview>Redux</a></li></ul></div></div></section><footer id=footer class=legs><div class="has-text-centered content mt-6 pt-6 pb-6 mb-6"><div class="is-flex is-align-items-center is-justify-content-center is-size-7"><a href=https://github.com/ryjen/ryjen.github.io/issues/new>See an issue?</a>
&nbsp; | &nbsp;<div class=copyright>Â© all rights reserved, ryan jennings</div></div></div></footer><script src=/js/theme.min.js defer></script><script src=/js/app.min.js defer></script><script async defer data-website-id=b348cf02-9212-4e45-be35-bd529c1eb47a src=https://analytics.micrantha.com/umami.js></script></body></html>