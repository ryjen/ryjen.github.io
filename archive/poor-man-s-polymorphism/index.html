<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Poor Man's Polymorphism</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="dark light"><meta name=google-site-verification content="Crk6W-ckoApRrOZrv23ngLwPPTbzjzfZ4AQPElgS0pw"><meta name=description content="Web logs of a software development engineer, musician, artist and hockey player."><meta name=robots content="index, follow"><link rel=stylesheet href=/css/theme.min.css type=text/css><link href=/css/app.min.css rel=stylesheet type=text/css></head><body class=dark><header id=header class=shoulders><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><figure class="image is-32x32 mr-3"><img class=is-rounded src=/image/logo-profile.jpg alt=logo></figure>ryan jennings
</a><a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=nav><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></a></div><div id=nav class=navbar-menu><div class=navbar-end><a class=navbar-item href=/posts><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#rss"/></svg>
</span>blog
</a><a class=navbar-item href=/art><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#icons"/></svg>
</span>art
</a><a class=navbar-item href=/things><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#object-ungroup"/></svg>
</span>things
</a><a class=navbar-item href=/about><span class="icon is-small mr-3"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#info-circle"/></svg>
</span>about
</a><a role=button class="navbar-item themer" href=#><span class="icon is-small"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#yin-yang"/></svg></span></a></div></div></nav></header><section id=main class=abdomen><nav class="breadcrumb ml-4 is-small" aria-label=breadcrumbs><ul><li><a href=/>Home</a></li><li><a href=/archive/>Blog Archives</a></li><li class=is-active><a href=/archive/poor-man-s-polymorphism/>Poor Man's Polymorphism</a></li></ul></nav><div class=container><h1 class=title>Poor Man's Polymorphism</h1><div class=content><p>Found out that C structs can be casted between each other if the <strong>field types and ordering are the same</strong>. It is not portable code, but you can start too see how and why the virtual table and object oriented programming evolved in c++.</p><p>As far as I know it would still be possible to write this in c++, but as always, you should definitely not.</p><h4 id=a-quick-example>A Quick Example</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>Animal</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>eyes</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>Dog</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>eyes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* dog specific */</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>tail</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>Human</span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>eyes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* human specific */</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>brain</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Passing humans or dogs to any function that takes an animal with a cast.</p><pre tabindex=0><code>int look(Animal *this, int object) {
  this-&gt;eyes = object;
}

Dog *dog = new_dog();

look((Animal*) dog, obj);
</code></pre></div></div></section><footer id=footer class=legs><div class="has-text-centered content"><div class="is-flex is-align-items-center is-justify-content-center"><div class="has-text-centered m-3"><button id=themer class=themer type=button>enlighten</button></div><a href=https://github.com/ryjen/ryjen.github.io/issues/new>See an issue?</a></div><div class=copyright>Â© all rights reserved, ryan jennings</div></div></footer><script src=/js/theme.min.js defer></script><script src=/js/app.min.js defer></script><script async defer data-website-id=b348cf02-9212-4e45-be35-bd529c1eb47a src=https://analytics.micrantha.com/umami.js></script></body></html>