<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Hugo + Dokku + Wercker = Goodness</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="dark light"><meta name=google-site-verification content="Crk6W-ckoApRrOZrv23ngLwPPTbzjzfZ4AQPElgS0pw"><meta name=description content="personal blog of an engineer, musician, and madman"><meta name=robots content="index, follow"><link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,900&family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap" rel=preload type=font/otf as=font><link rel=stylesheet href=/css/theme.min.css?v=d2f57ceecd7bd1b89f35e6c1741c0f35 type=text/css><link href=/css/app.min.css?v=b63046050031e39c6845169e821397a3 rel=stylesheet type=text/css></head><body><header id=header class=shoulders><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><figure class="image is-32x32 mr-3"><img class=is-rounded src=/image/logo-profile.png alt=logo></figure>ryan jennings</a>
<a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=#nav><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=nav class=navbar-menu><div class=navbar-end><a class=navbar-item href=/posts><span class="icon is-small mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#rss"/></svg></span>blog</a>
<a class=navbar-item href=/art><span class="icon is-small mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#icons"/></svg></span>art</a>
<a class=navbar-item href=/things><span class="icon is-small mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#object-ungroup"/></svg></span>things</a>
<a class=navbar-item href=/about><span class="icon is-small mr-3"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#info-circle"/></svg></span>about</a>
<a role=button class="navbar-item themer" href=#><span class="icon is-small"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#yin-yang"/></svg></span></a></div></div></nav></header><section id=main class=abdomen><nav class="breadcrumb ml-4 is-small" aria-label=breadcrumbs><ul><li><a href=/>Home</a></li><li><a href=/archive/>Blog Archives</a></li><li class=is-active><a href=/archive/hugo-dokku-wercker-goodness/>Hugo + Dokku + Wercker = Goodness</a></li></ul></nav><div class=container><h1 class=title>Hugo + Dokku + Wercker = Goodness</h1><div class=content><h2 id=hugohttpgohugoio><a href=http://gohugo.io>Hugo</a></h2><p>Hugo is a static site generator with many powerful features like archtypes, themes, customization, etc.</p><p>Combined with tools like <a href=http://bower.io>bower</a> and <a href=http://brunch.io>brunch</a> it makes for a pretty powerful app that could be more than a blog.</p><p>The workflow is simple - build your assets with brunch, run the hugo generator.
The end result is a complete static html site you can deploy.</p><h3 id=dokkuhttpdokkuviewdocsiodokku><a href=http://dokku.viewdocs.io/dokku/>Dokku</a></h3><p>Dokku has been great for running multiple small apps on a single <a href=http://digitialocean.com>digitalocean</a> droplet. The best part is its heroku buildpack compatible, so anything you can run on heroku you can deploy to dokku and more.</p><h2 id=werckerhttpwerckercom><a href=http://wercker.com>Wercker</a></h2><p>A continuous integration solution that is quite powerful and free. I&rsquo;m slowly migrating all my <a href=http://travis-ci.org>travisci</a> configurations.</p><p>With a single wercker.yml config file, each git commit one can combine the static site generation and the deploy to dokku. Beautiful!</p><h3 id=requirements>Requirements</h3><ul><li>add the dokku git repo as a submodule called &ldquo;public&rdquo; which will contain the generated site</li><li>create some dokku git environment variables in wercker config</li><li>create an ssh key in the wercker config for the project</li><li>add the generated ssh key to the dokku acl list</li></ul><p>The wercker.yml file:</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-YAML data-lang=YAML><span style=font-weight:700>box</span>: digitallyseamless/nodejs-bower-grunt
<span style=font-weight:700>build</span>:
  <span style=font-weight:700>steps</span>:
    - wercker/npm-install@1.1.4
    - plasticine/bower-install@0.0.4
    - <span style=font-weight:700>add-to-known-hosts</span>:
        <span style=font-weight:700>hostname</span>: $GIT_DEPLOY_HOST
    - <span style=font-weight:700>add-ssh-key</span>:
        <span style=font-weight:700>keyname</span>: dokku
    - <span style=font-weight:700>script</span>:
        <span style=font-weight:700>name</span>: Initialize git submodules
        <span style=font-weight:700>code</span>: |<span style=color:#0ff;font-weight:700>
</span><span style=color:#0ff;font-weight:700>            </span>            git submodule update --init --recursive
    - <span style=font-weight:700>script</span>:
        <span style=font-weight:700>name</span>: Build assets
        <span style=font-weight:700>code</span>: ./node_modules/.bin/brunch build
    - <span style=font-weight:700>arjen/hugo-build</span>:
        <span style=font-weight:700>version</span>: <span style=color:#0ff;font-weight:700>&#34;0.15&#34;</span>
<span style=font-weight:700>deploy</span>:
  <span style=font-weight:700>steps</span>:
    - <span style=font-weight:700>add-to-known-hosts</span>:
        <span style=font-weight:700>hostname</span>: $GIT_DEPLOY_HOST
    - <span style=font-weight:700>add-ssh-key</span>:
        <span style=font-weight:700>keyname</span>: dokku
    - <span style=font-weight:700>script</span>:
        <span style=font-weight:700>name</span>: push to dokku
        <span style=font-weight:700>code</span>: |<span style=color:#0ff;font-weight:700>
</span><span style=color:#0ff;font-weight:700>          cd ./public
</span><span style=color:#0ff;font-weight:700>          git config user.email &#34;$GIT_USER_EMAIL&#34;
</span><span style=color:#0ff;font-weight:700>          git config user.name &#34;$WERCKER_STARTED_BY&#34;
</span><span style=color:#0ff;font-weight:700>          git config push.default simple
</span><span style=color:#0ff;font-weight:700>          git add -A .
</span><span style=color:#0ff;font-weight:700>          git commit -m &#34;deploy from wercker&#34;
</span><span style=color:#0ff;font-weight:700>          git push origin HEAD:master</span>          
</code></pre></div><h4 id=result>Result?</h4><p>Can simply create a post and commit it. Once pushed, it will be deployed live.</p><h4 id=improvements>Improvements?</h4><ul><li>Create a test suite to run in wercker as well.</li><li>Devise a way to create a blog post on mobile</li></ul></div></div></section><footer id=footer class=legs><div class="has-text-centered content"><div class="is-flex is-align-items-center is-justify-content-center"><div class="has-text-centered m-3"><button id=themer class=themer type=button>enlighten</button></div><a href=https://github.com/ryjen/ryjen.github.io/issues/new>See an issue?</a></div><div class=copyright>Â© all rights reserved, ryan jennings</div></div></footer><script src=/js/vendor.min.js?v=5b18b0c85645356191577d423cb80506 defer></script><script src=/js/theme.min.js?v=c8e5ffd52b7736f12465f4402956eae8 defer></script><script src=/js/app.min.js?v=696d6f2a41284c393703636e4a6d540d defer></script><script data-goatcounter=https://analytics.micrantha.com/count async src=//analytics.micrantha.com/count.js></script></body></html>