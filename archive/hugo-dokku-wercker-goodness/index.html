<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Hugo + Dokku + Wercker = Goodness</title>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="dark light"><meta name=google-site-verification content="Crk6W-ckoApRrOZrv23ngLwPPTbzjzfZ4AQPElgS0pw"><meta name=description content="Web logs of a software development engineer, musician, artist and hockey player."><meta name=robots content="index, follow"><link rel=stylesheet href=/css/theme.min.css type=text/css><link href=/css/app.min.css rel=stylesheet type=text/css></head><body><header id=header class=shoulders><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><figure class="image is-32x32"><img class=is-rounded src=https://gravatar.com/avatar/7cb4299e74a72928a9f05e8e910f07d5 alt=logo></figure>ryan jennings
</a><a role=button class=navbar-burger aria-label=menu aria-expanded=false data-target=nav><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></a></div><div id=nav class=navbar-menu><div class=navbar-end><a class="navbar-item mr-3" href=/posts><span class="icon is-small mr-2"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#rss"/></svg>
</span>blog
</a><a class="navbar-item mr-3" href=/art><span class="icon is-small mr-2"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#icons"/></svg>
</span>art
</a><a class="navbar-item mr-3" href=/things><span class="icon is-small mr-2"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#object-ungroup"/></svg>
</span>things
</a><a class="navbar-item mr-3" href=/about><span class="icon is-small mr-2"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#circle-info"/></svg>
</span>about
</a><a role=button class="navbar-item themer" href=#><span class="icon is-small mr-2"><svg xmlns:xlink="http://www.w3.org/1999/xlink"><use xlink:href="/fonts/solid.svg#yin-yang"/></svg></span></a></div></div></nav></header><section id=main class=abdomen><nav class="breadcrumb ml-4 is-small" aria-label=breadcrumbs><ul><li><a href=/>Home</a></li><li><a href=/archive/>Blog Archives</a></li><li class=is-active><a href=/archive/hugo-dokku-wercker-goodness/>Hugo + Dokku + Wercker = Goodness</a></li></ul></nav><div class=container><h1 class=title>Hugo + Dokku + Wercker = Goodness</h1><div class=content><h2 id=hugo><a href=http://gohugo.io>Hugo</a></h2><p>Hugo is a static site generator with many powerful features like archtypes, themes, customization, etc.</p><p>Combined with tools like <a href=http://bower.io>bower</a> and <a href=http://brunch.io>brunch</a> it makes for a pretty powerful app that could be more than a blog.</p><p>The workflow is simple - build your assets with brunch, run the hugo generator.
The end result is a complete static html site you can deploy.</p><h3 id=dokku><a href=http://dokku.viewdocs.io/dokku/>Dokku</a></h3><p>Dokku has been great for running multiple small apps on a single <a href=http://digitialocean.com>digitalocean</a> droplet. The best part is its heroku buildpack compatible, so anything you can run on heroku you can deploy to dokku and more.</p><h2 id=wercker><a href=http://wercker.com>Wercker</a></h2><p>A continuous integration solution that is quite powerful and free. I&rsquo;m slowly migrating all my <a href=http://travis-ci.org>travisci</a> configurations.</p><p>With a single wercker.yml config file, each git commit one can combine the static site generation and the deploy to dokku. Beautiful!</p><h3 id=requirements>Requirements</h3><ul><li>add the dokku git repo as a submodule called &ldquo;public&rdquo; which will contain the generated site</li><li>create some dokku git environment variables in wercker config</li><li>create an ssh key in the wercker config for the project</li><li>add the generated ssh key to the dokku acl list</li></ul><p>The wercker.yml file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-YAML data-lang=YAML><span class=line><span class=cl><span class=nt>box</span><span class=p>:</span><span class=w> </span><span class=l>digitallyseamless/nodejs-bower-grunt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>wercker/npm-install@1.1.4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>plasticine/bower-install@0.0.4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>add-to-known-hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class=l>$GIT_DEPLOY_HOST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>add-ssh-key</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>keyname</span><span class=p>:</span><span class=w> </span><span class=l>dokku</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Initialize git submodules</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>code</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>            git submodule update --init --recursive</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build assets</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>code</span><span class=p>:</span><span class=w> </span><span class=l>./node_modules/.bin/brunch build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>arjen/hugo-build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.15&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>add-to-known-hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class=l>$GIT_DEPLOY_HOST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>add-ssh-key</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>keyname</span><span class=p>:</span><span class=w> </span><span class=l>dokku</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>push to dokku</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>code</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          cd ./public
</span></span></span><span class=line><span class=cl><span class=sd>          git config user.email &#34;$GIT_USER_EMAIL&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          git config user.name &#34;$WERCKER_STARTED_BY&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          git config push.default simple
</span></span></span><span class=line><span class=cl><span class=sd>          git add -A .
</span></span></span><span class=line><span class=cl><span class=sd>          git commit -m &#34;deploy from wercker&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          git push origin HEAD:master</span><span class=w>
</span></span></span></code></pre></div><h4 id=result>Result?</h4><p>Can simply create a post and commit it. Once pushed, it will be deployed live.</p><h4 id=improvements>Improvements?</h4><ul><li>Create a test suite to run in wercker as well.</li><li>Devise a way to create a blog post on mobile</li></ul></div></div></section><footer id=footer class=legs><div class="has-text-centered content"><div class="is-flex is-align-items-center is-justify-content-center"><div class="has-text-centered m-3"><button id=themer class=themer type=button>enlighten</button></div><a href=https://github.com/ryjen/ryjen.github.io/issues/new>See an issue?</a></div><div class=copyright>Â© all rights reserved, ryan jennings</div></div></footer><script src=/js/theme.min.js defer></script><script src=/js/app.min.js defer></script><script async defer data-website-id=b348cf02-9212-4e45-be35-bd529c1eb47a src=https://analytics.micrantha.com/umami.js></script></body></html>