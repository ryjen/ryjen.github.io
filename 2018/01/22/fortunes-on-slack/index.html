<!doctype html><html class=no-js lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Fortunes on Slack</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=google-site-verification content="Crk6W-ckoApRrOZrv23ngLwPPTbzjzfZ4AQPElgS0pw"><meta name=description content="personal blog of an engineer, musician, and madman"><meta name=ROBOTS content="INDEX, FOLLOW"><link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,900&family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap" rel="stylesheet preload"><link rel="stylesheet preload" href=/css/theme.min.css><link href=/css/app.min.css rel=stylesheet></head><body><div id=header class=clearfix><div class="container clearfix"><div id=brand><a href=/><span class=brand>ryan jennings</span></a></div><div id=menu-toggle><i class="fas fa-bars"></i></div><nav><ul class="nav navbar-nav menu"><li class="nav-item nav-toggle"><a href=/verbage><i class="fas fa-newspaper"></i><span class=nav-name>verbage</span></a></li><ul class=nav-sub-menu><li class=nav-item><a href=/post><i class="fas fa-rss"></i><span class=nav-name>blog</span></a></li><li class=nav-item><a href=/musings><i class="fas fa-comment-dots"></i><span class=nav-name>musings</span></a></li></ul><li class="nav-item nav-toggle"><a href=/art><i class="fas fa-icons"></i><span class=nav-name>art</span></a></li><ul class=nav-sub-menu><li class=nav-item><a href=/music><i class="fas fa-music"></i><span class=nav-name>music</span></a></li><li class=nav-item><a href=/doodles><i class="fas fa-image"></i><span class=nav-name>doodles</span></a></li><li class=nav-item><a href=/post/poems><i class="fas fa-pen-nib"></i><span class=nav-name>poems</span></a></li></ul><li class="nav-item nav-toggle"><a href=/things><i class="fas fa-object-ungroup"></i><span class=nav-name>things</span></a></li><ul class=nav-sub-menu><li class=nav-item><a href=/things/books><i class="fas fa-book"></i><span class=nav-name>books</span></a></li><li class=nav-item><a href=/things/tech><i class="fas fa-robot"></i><span class=nav-name>tech</span></a></li></ul></ul></nav></div></div><div class=container><div id=main><div class=header><h1>Fortunes on Slack</h1><p class=subtitle>witty antidotes in a service</p><div class="subheader clearfix"><div class=readinfo>ETA: 486 words, 3 minutes</div>&nbsp;|&nbsp;<div class=timestamps>Created: January 22, 2018</div></div></div><div class=text-justify><p><a href=https://fortunes.micrantha.com>view the service homepage</a></p><h4 id=introduction>Introduction</h4><p>Have always enjoyed the <a href=https://en.wikipedia.org/wiki/Fortune_%28Unix%29>UNIX fortunes</a> program, ever since I was a wee <a href=https://en.wikipedia.org/wiki/Newbie>newbie</a>. If you aren&rsquo;t familiar with it (sad), yes, its like a fortune cookie.</p><p>It can be more technical in nature but not always. It also has poems, quotations, and if enabled - offensive content.</p><p>Often I would find a fortune I&rsquo;d like to share and pipe it to a snippet from the terminal. There has to and must be a better way!</p><p>This time a Slack application has appeared on my radar as a target.</p><h4 id=man-the-sonar>Man the Sonar</h4><p>Cannot engage the target without some information.</p><p>The existing fortunes database will provide plenty of content. Fortunately (no pun intended), I&rsquo;ve already extracted the legacy flat file storage system into SQL for another project.</p><p><code>TODO: add conversion to SQL details</code></p><p>Had to make a few changes, a link table here, few fields there, but the gist is I have a PostgreSQL initialization script of fortunes.</p><h4 id=cut-me-some-slack>Cut me some Slack</h4><p>Got the data (got the life), how does Slack care?</p><p>The user enters a slash command and Slack will send a torpedo to my server by means of an HTTP JSON post.</p><p>My server will then typically counter measure with what they call an &ldquo;Ephemeral Message&rdquo;.</p><p>The counter measure will have an attachment to give an option to make the message visible to the current channel (by means of another torpedo and counter measure).</p><p><code>TODO: detail more the key parts, json and oauth</code></p><h4 id=alright-captain-tell-me-about-your-ship>Alright Captain, Tell me About Your Ship</h4><p>First, say &ldquo;I was born on a pirate ship&rdquo; 5 times fast. OK, never mind.</p><p>This is a story about a gopher and a whale in a secure proxy.</p><p>In other words, I&rsquo;m just running golang, in a docker container, behind NGINX with lets-encrypt.</p><p><img src=/image/blog/architecture.png alt="fortunes architecture"></p><h4 id=ok-what-if-a-torpedo-hits>OK, What if a Torpedo Hits?</h4><p>Yeah, I don&rsquo;t think the world will be falling over itself to use the fortunes service, but if they do, I will start charging to spin up more droplets and a load balancer.</p><p>As I&rsquo;m using docker, switching to AWS Fargate is possible too with a Docker Compose file.</p><h4 id=for-the-code-or-gopher-geeks>For the Code or Gopher Geeks</h4><p>As most gophers already know, the beauty of go besides its concurrency is its simplicity and its awesome packages.</p><p>For HTTP is you really don&rsquo;t need anything. The standard library is so simple yet so effective. Your endpoints become functions, your functions become routed to paths, and you serve. The standard template packages work great for layouts in the endpoint functions.</p><p>The server has two restful API&rsquo;s - the standard API and the Slack API. Both use the same process of serializing from the database to JSON by typical means of attributed data models.</p><p><code>TODO: add some code architecture details</code></p><h4 id=conclusion>Conclusion</h4><p>Random fortune cookies are fun. Slack is fun. Golang is awesome. Docker is pleasing.</p><p>Check out <a href=https://fortunes.micrantha.com>the final solution</a> page.</p><p><code>TODO: implement mobile apps</code></p></div></div></div><hr><div class=container><div id=related><h5>Related:</h5><div class="card item bg-default post clearfix" data-link=/2020/06/25/git-notes-storage/><div class=card-header><h1>Git Notes Storage</h1><div class=card-date>Jun 25, 2020</div></div><div class=card-content><p>a small blurb on using git notes for versioning and a storage mechanism</p></div><div class=card-footer><div class=item-tags><span class=item-tag>git</span>
<span class=item-tag>version</span>
<span class=item-tag>notes</span></div><div>3 min read</div></div></div><div class="card item bg-default post clearfix" data-link=/2019/07/05/mirroring-git-with-jenkins/><div class=card-header><h1>Mirroring git with jenkins</h1><div class=card-date>Jul 5, 2019</div></div><div class=card-content><p>A short look at automating git repository mirroring.</p></div><div class=card-footer><div class=item-tags><span class=item-tag>git</span>
<span class=item-tag>mirror</span>
<span class=item-tag>jenkins</span></div><div>2 min read</div></div></div><div class="card item bg-default post clearfix" data-link=/2019/02/07/a-self-hosting-journey/><div class=card-header><h1>A self hosting journey</h1><div class=card-date>Feb 7, 2019</div></div><div class=card-content><p>Setting up your own cloud services</p></div><div class=card-footer><div class=item-tags><span class=item-tag>self-hosting</span>
<span class=item-tag>hosting</span>
<span class=item-tag>docker</span>
<span class=item-tag>cloud</span>
<span class=item-tag>services</span>
<span class=item-tag>server</span></div><div>3 min read</div></div></div></div></div><hr><div class=container></div></div><div id=footer><script data-goatcounter=https://analytics.micrantha.com/count async src=//analytics.micrantha.com/count.js></script><button id=themer class=center type=button>enlighten</button><div class="menu center"><ul><li><a href=mailto:robert@ryanjennin.gs aria-label=email><i class="fa-3x fas fa-envelope"></i></a></li><li><a href=https://micrantha.com aria-label=biz><i class="fa-3x fas fa-building"></i></a></li><li><a href=https://github.com/ryjen aria-label=github><i class="fa-3x fab fa-github"></i></a></li><li><a href=https://linkedin.com/in/ryjen aria-label=linkedin><i class="fa-3x fab fa-linkedin"></i></a></li></ul></div><div class=center>Â© all rights reserved, ryan jennings</div></div><script src=/js/vendor.min.js defer></script><script src=/js/theme.min.js defer></script><script src=/js/app.min.js defer></script><script data-goatcounter=https://analytics.micrantha.com/count async src=//analytics.micrantha.com/count.js></script></body></html>